{% extends "home/base.html" %}


{% block title %}Carte mentale{% endblock %}

{% block content %}

<form method="post">
    {% csrf_token %}

    <!-- Barre d'outils -->
    <div class="d-flex justify-content-between align-items-center mb-3">

        <!-- Titre de la carte -->
        <input
            type="text"
            name="title"
            id="mindmap_title"
            class="form-control me-3"
            placeholder="Titre de la carte"
            value="{{ object.title|default:'Nouvelle carte' }}"
            required
        >

        <!-- Boutons et personnalisation -->
        <div class="d-flex flex-wrap align-items-center mb-3">

            <label class="me-2">Couleur nÅ“ud:</label>
            <input type="color" id="node_color" value="#ffa500" class="me-3">

            <label class="me-2">Couleur texte:</label>
            <input type="color" id="text_color" value="#000000" class="me-3">

            <label class="me-2">Texte:</label>
            <input type="text" id="node_text" placeholder="Texte du nÅ“ud" class="me-3">

            <button type="button" id="add_node_btn" class="btn btn-success me-1">
                âž• Ajouter un nÅ“ud
            </button>

            <button type="submit" id="save_btn" class="btn btn-primary me-1">
                ðŸ’¾ Enregistrer
            </button>

            <a href="{% url 'mindmap:mindmap-list' %}" class="btn btn-secondary">
                Retour
            </a>
        </div>
    </div>

    <!-- Champ cachÃ© pour stocker le JSON -->
    <input type="hidden" name="data" id="mindmap_data">

    <!-- Container jsMind -->
    <div id="jsmind_container"
         style="width:100%; height:600px; border:1px solid #ccc;">
    </div>

</form>

<!-- Injection des donnÃ©es JSON existantes -->
{% if object %}
    {{ object.data|json_script:"mind_data" }}
{% else %}
    <script id="mind_data" type="application/json">{}</script>
{% endif %}

{% endblock content %}

{% block extra_js %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsmind/style/jsmind.css">
<script src="https://cdn.jsdelivr.net/npm/jsmind/js/jsmind.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jsmind/js/jsmind.draggable.js"></script>
<script src="{% static 'mindmap/script.js' %}"></script>
{% endblock extra_js %}
